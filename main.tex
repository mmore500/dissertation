%%% Define the actual document parameters:
% as of Dec 2022, formatting guide requires margins be "consistent on all sides"
% i.e., use oneside
\documentclass[oneside,12pt,letterpaper,openany]{report}

% allow for large numbers of floats without
% https://tex.stackexchange.com/a/241006
\extrafloats{1024}

%%%  Include packages used throughout the dissertation:
\input{tex/packages.tex}

% suppress generation of unwanted empty pages
% this shouldn't be necessary, but (strangely) is
% note that the placeins package prevents float leak between chapters by
% preventing float leak between sections
% save original clearpage
\let\originalclearpage\clearpage

\renewcommand{\clearpage}{\newpage}
\let\cleardoublepage\newpage
\let\cleardoubleoddpage\newpage
\let\cleardoubleevenpage\newpage

% prevent figure leakage
\let\Oldchapter\chapter
\renewcommand{\chapter}{\FloatBarrier\Oldchapter}

\let\Oldsection\section
\renewcommand{\section}{\FloatBarrier\Oldsection}

% this would be more targeted approach to suppressing unwanted empty pages,
% but doesn't work
% \patchcmd{\chapter}{\clearpage}{}{\typeout{chapter macro patched}}{}
% \patchcmd{\chapter}{\cleardoublepage}{}{\typeout{chapter macro patched}}{}
% \patchcmd{\chapter}{\cleardoubleoddpage}{}{\typeout{chapter macro patched}}{}
% \patchcmd{\chapter}{\cleardoubleevenpage}{}{\typeout{chapter macro patched}}{}
% \patchcmd{\part}{\clearpage}{}{\typeout{part macro patched}}{}
% \patchcmd{\part}{\cleardoublepage}{}{\typeout{part macro patched}}{}
% \patchcmd{\part}{\cleardoubleoddpage}{}{\typeout{part macro patched}}{}
% \patchcmd{\part}{\cleardoubleevenpage}{}{\typeout{part macro patched}}{}
% \patchcmd{\section}{\clearpage}{}{\typeout{section macro patched}}{}
% \patchcmd{\section}{\cleardoublepage}{}{\typeout{section macro patched}}{}
% \patchcmd{\section}{\cleardoubleoddpage}{}{\typeout{section macro patched}}{}
% \patchcmd{\section}{\cleardoubleevenpage}{}{\typeout{section macro patched}}{}
% % see https://stackoverflow.com/a/2290338
% \patchcmd{\include}{\clearpage}{}{\typeout{include macro patched}}{}
% \patchcmd{\include}{\cleardoublepage}{}{\typeout{include macro patched}}{}
% \patchcmd{\include}{\cleardoubleoddpage}{}{\typeout{include macro patched}}{}
% \patchcmd{\include}{\cleardoubleevenpage}{}{\typeout{include macro patched}}{}

%%% Colors for tracking changes. %%%
%%% Use: \cut{<Text you want to cut.>} -> Makes the text red.
%%% Great for tracking changes that you send to advisor/committee.
\newcommand*\cut{\textcolor{red}}
\newcommand*\add{\textcolor{ForestGreen}}
\newcommand*\alter{\textcolor{blue}}

% ensure no headers have font size greater than 14
\sectionfont{\fontsize{14}{15}\selectfont}
\subsectionfont{\fontsize{12}{15}\selectfont}

% adapted from https://tex.stackexchange.com/a/53340
\titlespacing{\section}{0pt}{6pt}{0pt}
\titlespacing{\subsection}{0pt}{6pt}{0pt}
\titlespacing{\subsubsection}{0pt}{6pt}{0pt}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%% Use the following to format your titles for the Table of Contents, List of Figures, List of Tables.
%\renewcommand{\cfttoctitlefont}{\normalfont\Large\bfseries\MakeUppercase}
% ---- 2021-05-06 - pre-msu-revision ----
% \setlength{\cftbeforetoctitleskip}{-0.2in}
% \setlength{\cftaftertoctitleskip}{0.1875in}
% ------
\setlength{\cftaftertoctitleskip}{0in}
\setlength{\cftbeforetoctitleskip}{0in}
\renewcommand{\cfttoctitlefont}{\hfill\bfseries}
\renewcommand{\cftaftertoctitle}{\hfill}
\renewcommand{\contentsname}{\centerline{TABLE OF CONTENTS}}

\renewcommand\cftpartfont{\bfseries}
\renewcommand\cftchapfont{}
\renewcommand\cftsecfont{}

\renewcommand\cftpartpagefont{\bfseries}
\renewcommand\cftchappagefont{}
\renewcommand\cftsecpagefont{}

\setlength{\cftbeforepartskip}{2pc}
\setlength{\cftbeforechapskip}{1pc}
\setlength{\cftbeforesecskip}{0pc}

% MSU now only requires (and prefers) chapters to be listed
\setcounter{tocdepth}{0}
% Add dot leaders to the chapter entries in the TOC
\renewcommand{\cftchapleader}{\cftdotfill{\cftdotsep}}

\setlength{\cftbeforeloftitleskip}{-0.17in}
\setlength{\cftafterloftitleskip}{0.1875in}
\renewcommand{\cftloftitlefont}{\hfill\Large\bfseries}
\renewcommand{\cftafterloftitle}{\hfill}
\renewcommand{\listfigurename}{\large\centering{LIST OF FIGURES}}

\setlength{\cftbeforelottitleskip}{-0.33in}
\setlength{\cftafterlottitleskip}{0.3875in}
\renewcommand{\cftlottitlefont}{\hfill\Large\bfseries}
\renewcommand{\cftafterlottitle}{\hfill}
\renewcommand{\listtablename}{\large\centering{LIST OF TABLES}}

%%% Bibliography setup for TOC and The Final Page %%%%
\renewcommand{\bibname}{\vspace*{-0.95in} \large\centering{BIBLIOGRAPHY}}

%%% Put colon after figure number in the list of figures %%%
\renewcommand{\cftfigpresnum}{Figure\ }
\renewcommand{\cftfigaftersnum}{:\ }

%%% Put Table before and colon after table number in the list of tables %%%
\renewcommand{\cfttabpresnum}{Table\ }
\renewcommand{\cfttabaftersnum}{:\ }

% Put spacing after the Table #: and Figure #: in the LOF and LOT
\newlength{\mylenf}
\settowidth{\mylenf}{\cftfigpresnum}
\setlength{\cftfignumwidth}{\dimexpr\mylenf+0.35in}
\setlength{\cfttabnumwidth}{\dimexpr\mylenf+0.35in}

% Use this in conjunction with making the LOT singlespace so that long table entries are
% single space within entries and double space between entries
\renewcommand\cfttabafterpnum{\vskip\baselineskip}

%%% Put Chapter before number in the TOC %%%
\renewcommand\chaptername{Chapter}
\renewcommand\cftchappresnum{\chaptername\space}
\setlength{\cftchapnumwidth}{\widthof{\textbf{Chapter~999~}}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\fancypagestyle{mylandscape}{%
  \fancyhf{}% Clear header/footer
  \fancyfoot{% Footer
    \makebox[\textwidth][r]{% Right
      \rlap{\hspace{-.13in}%\footskip}% Push out of margin by \footskip
        \smash{% Remove vertical height
          \raisebox{\dimexpr.5\baselineskip+\footskip+.66\textheight}{% Raise vertically
            \rotatebox{90}{\thepage}}}}}}% Rotate counter-clockwise
  \renewcommand{\headrulewidth}{0pt}% No header rule
  \renewcommand{\footrulewidth}{0pt}% No footer rule
}

%%% Renew command for full page figures:
\renewcommand{\topfraction}{1.0}

% Blank page (if needed)
\newcommand\blankpage{%
    \null
    \thispagestyle{empty}%
    \addtocounter{page}{-1}%
    \newpage}

%%%  Set the margins as required by the MSU graduate school.
%%%  Specifically, set the margins 1 inch top bottom and right,
%%%  1.5 inch on left.  Now, Latex has margin origins at 1 in on the top
%%%  and left so for 1.5 in the margin is set at 1.5 - 1 = .5 inch
%\setlength{\oddsidemargin}{.5in}   % This is the left margin for both
%\setlength{\evensidemargin}{1.5in} % even and odd pages (in case you use the book format)
\setlength{\topmargin}{0in} % Top margin (remember latex starts from 1 in)

% Pagewidth(8.5in) - textwidth(6in) - leftmargins(1.5in) = 1 inch for right margin
\setlength{\textwidth}{6.5in}

% Page height (11in) - Topmargin (1in) - Textheight (1in) = 1 in for
%                                                      bottom margin
\setlength{\textheight}{9in} %
\setlength{\footskip}{.5in}
%%% Headings are not required, thus suppress:
\setlength{\headheight}{0in}
\setlength{\headsep}{0in}

\newsavebox{\savefig}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%  Include any definitions you wish to use throughout the dissertation:
\input{tex/macros.tex}

\ifdefined\mydraft
\mydraft
\fi

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%  Begin the actual dissertation:
\begin{document}
\raggedbottom
\sloppy
\pagenumbering{gobble}
\setlength{\parindent}{2 em}

%\layout

%%%  Title Page:
% adapted from https://tex.stackexchange.com/a/601029
\begin{titlepage}
\begin{center}
  % title 2 inches from top of page
  \begin{textblock}{
     \fpeval{(8.5 - 2.0) / 8.5} % width
    }(
      \fpeval{1.0 / 8.5}, % xpos
      \fpeval{2.0 / 11.0} % ypos
    )
    \centering
    \MakeUppercase{\thesisTitle}
   \end{textblock}

   % By 3.5 inches from top of page
   \begin{textblock}{
      \fpeval{(8.5 - 2.0) / 8.5} % width
     }(
       \fpeval{1.0 / 8.5}, % xpos
       \fpeval{3.5 / 11.0} % ypos
     )
     \centering
     By
    \end{textblock}

    % author name 4 inches from top of page
    \begin{textblock}{
       \fpeval{(8.5 - 2.0) / 8.5} % width
      }(
        \fpeval{1.0 / 8.5}, % xpos
        \fpeval{4.0 / 11.0} % ypos
      )
      \centering
      \authorName
     \end{textblock}

    % document name 7 inches from top of page
    \begin{textblock}{
      \fpeval{(8.5 - 2.0) / 8.5} % width
     }(
       \fpeval{1.0 / 8.5}, % xpos
       \fpeval{7.0 / 11.0} % ypos
     )
     \centering
      A DISSERTATION % Check regulations for Masters
    \end{textblock}

    % submitted to 7.5 inches from top of page
    \begin{textblock}{
      \fpeval{(8.5 - 2.0) / 8.5} % width
     }(
       \fpeval{1.0 / 8.5}, % xpos
       \fpeval{7.5 / 11.0} % ypos
     )
     \centering
     Submitted to\\
     Michigan State University\\
     in partial fulfillment of the requirements\\
     for the degree of\\
    \end{textblock}

    % degree(s) 8.5 inches from top of page
    \begin{textblock}{
      \fpeval{(8.5 - 2.0) / 8.5} % width
     }(
       \fpeval{1.0 / 8.5}, % xpos
       \fpeval{8.5 / 11.0} % ypos
     )
     \centering
     Computer Science - Doctor of Philosophy\\
     Ecology, Evolutionary Biology, and Behavior - Dual Major
    \end{textblock}

    % year 9 inches from top of page
    \begin{textblock}{
      \fpeval{(8.5 - 2.0) / 8.5} % width
     }(
       \fpeval{1.0 / 8.5}, % xpos
       \fpeval{9 / 11.0} % ypos
     )
     \centering
     \graduationYear
    \end{textblock}

\end{center}
\null\newpage
\end{titlepage}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% == Abstract ==
\thispagestyle{empty} \setcounter{page}{4}
\begin{doublespace}

\centerline{\textbf{ABSTRACT}}

\input{tex/abstract.tex}

\end{doublespace}
\newpage
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\addtocounter{page}{-2}%

%%%%  Copyright page:
\thispagestyle{empty}
\topskip0pt
\vspace*{\fill}


{\raggedright
Copyright by\\
\MakeUppercase{\authorName}\\
\graduationYear
}
\vspace*{\fill}

\newpage


%%% Set the page numbering scheme:
% as of Dec 2022, roman page numbering must begin on dedication
\pagenumbering{roman}

%%%%  Dedication:
\topskip0pt
\vspace*{\fill}

{\centering
\input{tex/dedication.tex}
}

\vspace*{\fill}
\newpage


%%%%  Acknowledgements:
\begin{doublespace}
\centerline{
\textbf{ACKNOWLEDGEMENTS}
}

\input{tex/acknowledgements.tex}

\end{doublespace}
\newpage


\begin{singlespace}
\tableofcontents %

\newpage

%%%  List of tables:
% disabled!
% as of 2022 this is no longer required or encouraged by the graduate school
%
% \addcontentsline{toc}{chapter}{LIST OF TABLES}
%
% \begin{singlespace}
% \raggedbottom
% \listoftables
% \end{singlespace}
%
%
% \newpage
%
%%%  List of Figures:
% disabled!
% as of 2022 this is no longer required or encouraged by the graduate school
%
% \addcontentsline{toc}{chapter}{LIST OF FIGURES}
%
% \makeatletter
% \let\l@figureOLD \l@figure
% \renewcommand{\l@figure}{\vspace{\baselineskip}\l@figureOLD}
% \makeatother
% \addtocontents{lof}{\vspace*{-\baselineskip}}
% \raggedbottom
%
% \listoffigures
%
% \setlength{\topmargin}{0in}
% \newpage
% \setlength{\parskip}{0 cm} \setlength{\topmargin}{0in}

\end{singlespace}
%
%%%  This concludes the mandatory formatting for a dissertation.
%%%  Now, reset the page counter, and use arabic numerals for the remainder:
\setcounter{page}{1}\pagenumbering{arabic}


%%%  Last few formatting commands:
\begin{doublespace}



%% Change this for spacing:
%\onehalfspacing
\linespread{1.2}

%%%  Include the chapters of your dissertation:
%%% Use format: \include{<file here>(No Extension)}

\input{tex/body.tex}

%\pagenumbering{gobble}% Remove page numbers (and reset to 1)
%%%  Bibliography:

% \newpage
% \vspace*{\fill}
% \begin{center}
% BIBLIOGRAPHY
% \vspace*{\fill}
% \end{center}
\FloatBarrier
\originalclearpage
\begin{singlespace}
\addcontentsline{toc}{chapter}{BIBLIOGRAPHY}
\renewcommand{\bibsection}{\centerline{\textbf{BIBLIOGRAPHY}}}
\bibliographystyle{apalike}% your bst file here
\bibliography{out.bib} %your bib file here
\end{singlespace}

%%%  Appendices, if necessary:

\appendix
\renewcommand\chaptername{Appendix}
% ensure appendix chapters are labeled appendix instead of chapter in toc
% adapted from https://tex.stackexchange.com/a/56845
% see also https://tex.stackexchange.com/a/50037
\begin{filecontents}{toc-chapter-to-appendix.tex}
\addtocontents{toc}{\protect\renewcommand{\protect\cftchappresnum}{\appendixname\space}}
\end{filecontents}
\include{toc-chapter-to-appendix.tex}

\input{tex/appendix.tex} %====Put you Appendix text here

\end{doublespace}
\end{document}
